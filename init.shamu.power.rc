on charger
    #low power governing
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor powersave
    write /sys/devices/system/cpu/cpu1/online 0
    write /sys/devices/system/cpu/cpu2/online 0
    write /sys/devices/system/cpu/cpu3/online 0
    write /sys/module/lpm_levels/enable_low_power/l2 4
    write /sys/module/msm_pm/modes/cpu0/power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu0/power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu0/standalone_power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu0/standalone_power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu0/retention/idle_enabled 1

on boot
    # Shamu boots with performance governor.
    # Switch one core to interactive to set permissions, for power hal and system server.
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
    chown system system /sys/devices/system/cpu/cpufreq/interactive/timer_rate
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/timer_rate
    chown system system /sys/devices/system/cpu/cpufreq/interactive/timer_slack
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/timer_slack
    chown system system /sys/devices/system/cpu/cpufreq/interactive/min_sample_time
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/min_sample_time
    chown system system /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq
    chown system system /sys/devices/system/cpu/cpufreq/interactive/target_loads
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/target_loads
    chown system system /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load
    chown system system /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay
    chown system system /sys/devices/system/cpu/cpufreq/interactive/boost
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/boost
    chown system system /sys/devices/system/cpu/cpufreq/interactive/boostpulse
    #chown system system /sys/devices/system/cpu/cpufreq/interactive/input_boost
    #chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/input_boost
    chown system system /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration
    chown system system /sys/devices/system/cpu/cpufreq/interactive/io_is_busy
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/io_is_busy
    chown system system /sys/devices/system/cpu/cpufreq/interactive/sampling_down_factor
    chmod 0660 /sys/devices/system/cpu/cpufreq/interactive/sampling_down_factor

    # disable bcl
    write /sys/devices/qcom,bcl.39/mode disabled

on property:dev.bootcomplete=1
    write /sys/module/lpm_levels/enable_low_power/l2 4
    write /sys/module/msm_pm/modes/cpu0/power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu1/power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu2/power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu3/power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu0/power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu1/power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu2/power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu3/power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu0/standalone_power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu1/standalone_power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu2/standalone_power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu3/standalone_power_collapse/suspend_enabled 1
    write /sys/module/msm_pm/modes/cpu0/standalone_power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu1/standalone_power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu2/standalone_power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu3/standalone_power_collapse/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu0/retention/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu1/retention/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu2/retention/idle_enabled 1
    write /sys/module/msm_pm/modes/cpu3/retention/idle_enabled 1
    write /sys/module/msm_thermal/core_control/enabled 0
# ------------------------------------------------------------------------------------------------------------
# Removed, Drunk kernel config is below
     write /sys/kernel/msm_limiter/scaling_governor interactive
#    write /sys/module/msm_thermal/core_control/enabled 1
#    write /sys/devices/system/cpu/cpufreq/interactive/io_is_busy 1
#
    # cpufreq settings
    write /sys/kernel/msm_limiter/scaling_governor interactive
    write /sys/devices/system/cpu/cpufreq/interactive/io_is_busy 1
    write /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay "20000 1400000:40000 1700000:20000"
    write /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load 90
    write /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq 1497600
    write /sys/devices/system/cpu/cpufreq/interactive/target_loads "85 1500000:90 1800000:70"
    write /sys/devices/system/cpu/cpufreq/interactive/min_sample_time 40000
    write /sys/devices/system/cpu/cpufreq/interactive/sampling_down_factor 100000

    write /sys/kernel/msm_limiter/scaling_governor impulse
    write /sys/devices/system/cpu/cpufreq/impulse/above_hispeed_delay "19000 1400000:39000 1700000:19000"
    write /sys/devices/system/cpu/cpufreq/impulse/go_hispeed_load 99
    write /sys/devices/system/cpu/cpufreq/impulse/hispeed_freq 1497600
    write /sys/devices/system/cpu/cpufreq/impulse/io_is_busy 1
    write /sys/devices/system/cpu/cpufreq/impulse/max_freq_hysteresis 80000
    write /sys/devices/system/cpu/cpufreq/impulse/min_sample_time 40000
    write /sys/devices/system/cpu/cpufreq/impulse/powersave_bias 1
    write /sys/devices/system/cpu/cpufreq/impulse/target_loads "85 1500000:90 1800000:70"
    write /sys/devices/system/cpu/cpufreq/impulse/timer_rate 30000
    write /sys/devices/system/cpu/cpufreq/impulse/timer_slack 30000

    write /sys/module/cpu_boost/parameters/input_boost_freq 1497600
    write /sys/module/cpu_boost/parameters/input_boost_ms 500
    write /sys/module/cpu_boost/parameters/hotplug_boost 1
    write /sys/module/cpu_boost/parameters/wakeup_boost 1

    write /dev/cpuctl/cpu.notify_on_migrate 0
    write /sys/module/state_notifier/parameters/enabled 1
    write /sys/kernel/state_helper/enabled 1
    write /sys/kernel/state_helper/batt_level_cri 1
    write /sys/kernel/state_helper/batt_level_eco 15

    # Adaptive LMK
    write /sys/module/lowmemorykiller/parameters/enable_adaptive_lmk 1
    write /sys/module/lowmemorykiller/parameters/vmpressure_file_min 53059

    # Per-process reclaim
    write /sys/module/process_reclaim/parameters/enable_process_reclaim 1
    write /sys/module/process_reclaim/parameters/pressure_min 10
    write /sys/module/process_reclaim/parameters/per_swap_size 1024
    write /sys/module/process_reclaim/parameters/pressure_max 70
    write /sys/module/process_reclaim/parameters/swap_opt_eff 30

    # VM tuning
    write /proc/sys/vm/dirty_background_ratio 20
    write /proc/sys/vm/dirty_expire_centisecs 200
    write /proc/sys/vm/dirty_ratio 40
    write /proc/sys/vm/page-cluster 0
    write /proc/sys/vm/swappiness 0
    write /proc/sys/vm/vfs_cache_pressure 80

    # Configure Drunk Owl kernel ---- Start

    # - Enable Simple GPU algorithm
    write /sys/module/simple_gpu_algorithm/parameters/simple_gpu_activate "1"
    write /sys/module/simple_gpu_algorithm/parameters/simple_laziness "0"
    write /sys/module/simple_gpu_algorithm/parameters/simple_ramp_threshold "0"

    # - Setup CPU governor
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor "barry-allen"
    write /sys/devices/system/cpu/cpu1/online "1"
    write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor "barry-allen"
    write /sys/devices/system/cpu/cpu2/online "1"
    write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor "barry-allen"
    write /sys/devices/system/cpu/cpu3/online "1"
    write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor "barry-allen"
    restorecon_recursive /sys/devices/system/cpu/cpufreq

    # - Configure IntelliPlug
    stop mpdecision
    write /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_min_freq "223000"
    write /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_max_freq "2457600"
    write /sys/devices/system/cpu/cpu1/online "1"
    write /sys/devices/system/cpu/cpu1/cpufreq/cpuinfo_min_freq "223000"
    write /sys/devices/system/cpu/cpu1/cpufreq/cpuinfo_max_freq "2457600"
    write /sys/devices/system/cpu/cpu2/online "1"
    write /sys/devices/system/cpu/cpu2/cpufreq/cpuinfo_min_freq "223000"
    write /sys/devices/system/cpu/cpu2/cpufreq/cpuinfo_max_freq "2457600"
    write /sys/devices/system/cpu/cpu3/online "1"
    write /sys/devices/system/cpu/cpu3/cpufreq/cpuinfo_min_freq "223000"
    write /sys/devices/system/cpu/cpu3/cpufreq/cpuinfo_max_freq "2457600"
    write /sys/module/intelli_plug/parameters/intelli_plug_active "1"
    write /sys/module/intelli_plug/parameters/touch_boost_active "0"
    write /sys/module/intelli_plug/parameters/nr_run_profile_sel "2"
    write /sys/module/intelli_plug/parameters/nr_run_hysteresis "4"
    write /sys/module/intelli_plug/parameters/cpu_nr_run_threshold "3500"

    # - Configure IntelliThermal
    stop thermal-engine
    write /sys/module/msm_thermal/parameters/enabled "1"
    write /sys/module/msm_thermal/parameters/core_control_mask "12"
    write /sys/module/msm_thermal/parameters/freq_control_mask "15"
    write /sys/module/msm_thermal/parameters/limit_temp_degC "70"
    write /sys/module/msm_thermal/parameters/core_limit_temp_degC "75"

    # - Set Vibrator strength
    write /sys/vibrator/pwmvalue 70

    # - Set 6500K color calibration
    write /sys/devices/platform/kcal_ctrl.0/kcal "250 250 255"
    write /sys/devices/platform/kcal_ctrl.0/kcal_sat "243"
    write /sys/devices/platform/kcal_ctrl.0/kcal_cont "255"
    write /sys/devices/platform/kcal_ctrl.0/kcal_hue "1515"
    write /sys/devices/platform/kcal_ctrl.0/kcal_val "250"
    write /sys/devices/platform/kcal_ctrl.0/kcal_ctrl "1"

    # Switch to sioplus scheduler and increase readahead buffer to 1024Kb
    write /sys/block/mmcblk0/queue/scheduler sioplus
    write /sys/block/mmcblk0/bdi/read_ahead_kb 1024

    # Activate swap
    exec - root system -- /system/xbin/swapon.sh

    # Configure Drunk Owl kernel ---- End
